/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   config.conf                                 	:+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: thitran<thitran@student.42nice.fr>         +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2025/08/04 10:26:13 by thitran           #+#    #+#             */
/*   Updated: 2025/08/04 13:52:34 by thitran          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

# Main website served on port 8000
server {
    listen 8000;
    server_name localhost;
    root www;
    max_body_size 10M;                         # Limit client body size (e.g., 10MB)

    # Default error pages
    error_page 404 www/error_pages/404.html;
    error_page 500 www/error_pages/500.html;

    # Default index file
    index index.html;

    # Upload route
    location /upload {
        root www/uploads;
        upload_dir www/uploads;
        allow_upload on;
        method POST DELETE GET;
        autoindex on;
    }

    # Static file route
    location /static {
        root www/static;
        method GET;
        autoindex off;
        index index.html;
    }

    # Route with redirection
    location /redirect-me {
        return 301 http://lavenderwebfr.com/;
    }

    # CGI route for PHP
    location /cgi-bin {
        root www/cgi-bin;
        method POST GET;
        cgi_extension .php;
        cgi_path /usr/bin/php-cgi;
        autoindex off;
    }

    # CGI route for Python
    location /scripts {
        root www/scripts;
        method GET POST;
        cgi_extension .py;
        cgi_path /usr/bin/python3;
        autoindex off;
    }
}

# Another server on port 8001 (virtual host)
server {
    listen 8001;
    server_name test;
    root www_test;
    max_body_size 5M;

    error_page 404 www_test/error.html;

    location / {
        index index.html;
        method GET;
        autoindex off;
    }

    location /docs {
        root www_test/documents;
        method GET;
        autoindex on;
    }
}

/*
server {
    listen 8080;
    server_name localhost;
    root www;

    # Error page config
    error_page 404 www/error_pages/404.html;
    error_page 500 www/error_pages/500.html;

    # Upload route
    location /upload {
        root www/uploads;               # Upload destination directory
        upload_dir www/uploads;         # This is used by your server logic (if supported)
        allow_upload on;                # Custom directive (optional if supported by parser)
        method POST;                    # Accept only POST method for uploads
        autoindex on;                   # Optional: enable to view uploaded files
    }
}

server {
    listen 8081;
    server_name test;
    root www_test;

    # Error page config
    error_page 404 www_test/error.html;
}
*/

